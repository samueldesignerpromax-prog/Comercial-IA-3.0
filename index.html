<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerador de V√≠deo IA - Pollo.ai</title>
  <style>
    body {
      background: linear-gradient(135deg, #0a0f24, #1a237e);
      color: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-align: center;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }
    
    h1 {
      color: #00c3ff;
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-shadow: 0 0 10px rgba(0, 195, 255, 0.5);
    }
    
    .api-status {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 15px;
      margin: 20px auto;
      max-width: 600px;
      border-left: 4px solid #4CAF50;
    }
    
    .api-key {
      font-family: monospace;
      background: rgba(0, 0, 0, 0.5);
      padding: 8px 12px;
      border-radius: 5px;
      margin: 10px 0;
      color: #4CAF50;
      font-size: 0.9rem;
      word-break: break-all;
    }
    
    .btn {
      background: linear-gradient(45deg, #0d6efd, #00c3ff);
      color: white;
      padding: 15px 30px;
      border-radius: 50px;
      border: none;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: bold;
      margin: 15px;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(13, 110, 253, 0.4);
    }
    
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 195, 255, 0.6);
    }
    
    .btn:active {
      transform: translateY(-1px);
    }
    
    .btn-fallback {
      background: linear-gradient(45deg, #ff9800, #ff5722);
    }
    
    #status {
      margin: 25px auto;
      padding: 20px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      min-height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
    }
    
    video {
      width: 100%;
      max-width: 800px;
      border-radius: 10px;
      border: 3px solid #00c3ff;
      box-shadow: 0 0 30px rgba(0, 195, 255, 0.3);
      margin: 20px auto;
      display: block;
      background: #000;
    }
    
    .download-section {
      margin-top: 30px;
      padding: 20px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
    }
    
    .hidden {
      display: none;
    }
    
    .error {
      color: #ff5252;
      background: rgba(255, 82, 82, 0.1);
      border-left: 4px solid #ff5252;
    }
    
    .success {
      color: #4CAF50;
      background: rgba(76, 175, 80, 0.1);
      border-left: 4px solid #4CAF50;
    }
    
    .cors-warning {
      background: rgba(255, 193, 7, 0.1);
      border-left: 4px solid #ffc107;
      color: #ffc107;
      padding: 15px;
      border-radius: 10px;
      margin: 20px 0;
      text-align: left;
    }
    
    @media (max-width: 768px) {
      h1 { font-size: 2rem; }
      .btn { padding: 12px 24px; font-size: 1rem; }
      video { width: 95%; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üé¨ Gerador de V√≠deo IA - Pollo.ai</h1>
    <p>Teste da API com sua chave real</p>
    
    <div class="api-status">
      <h3>‚úÖ API Key Configurada</h3>
      <div class="api-key">pollo_1rCUxshDhx97hBHyzKBHgc2JSg6lVS4insiEFmLowFo0</div>
      <p>Status: <span id="apiStatusText">Pronto para testar</span></p>
    </div>
    
    <div class="cors-warning">
      <strong>‚ö†Ô∏è IMPORTANTE:</strong> A API pode bloquear requests direto do navegador (CORS).<br>
      Se n√£o funcionar, voc√™ precisa hospedar este site em um servidor (GitHub Pages, Netlify, etc.).
    </div>
    
    <button class="btn" onclick="gerarVideoIA()" id="btnGerar">
      üöÄ Gerar V√≠deo com IA
    </button>
    
    <button class="btn btn-fallback" onclick="usarVideoExemplo()">
      üìπ Usar V√≠deo de Exemplo
    </button>
    
    <div id="status">
      Clique em um bot√£o acima para come√ßar
    </div>
    
    <video id="videoPlayer" controls class="hidden"></video>
    
    <div class="download-section hidden" id="downloadSection">
      <h3>üì• Download do V√≠deo</h3>
      <button class="btn" onclick="baixarVideo()" id="btnDownload">
        üíæ Baixar V√≠deo
      </button>
      <p id="videoInfo"></p>
    </div>
    
    <div id="debugInfo" style="text-align: left; margin-top: 30px; font-size: 0.9rem; color: #aaa; display: none;">
      <h4>üîç Informa√ß√µes de Debug:</h4>
      <pre id="debugText"></pre>
    </div>
  </div>

  <script>
    // SUA NOVA API KEY
    const API_KEY = "pollo_1rCUxshDhx97hBHyzKBHgc2JSg6lVS4insiEFmLowFo0";
    let videoUrlAtual = "";
    
    async function gerarVideoIA() {
      const status = document.getElementById("status");
      const videoPlayer = document.getElementById("videoPlayer");
      const btnGerar = document.getElementById("btnGerar");
      const debugInfo = document.getElementById("debugInfo");
      const debugText = document.getElementById("debugText");
      
      // Reset
      status.className = "";
      status.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;"><span style="margin-right:10px;">üîÑ</span> Conectando √† API Pollo.ai...</div>';
      videoPlayer.classList.add("hidden");
      videoUrlAtual = "";
      btnGerar.disabled = true;
      btnGerar.innerHTML = "‚è≥ Processando...";
      
      debugInfo.style.display = "block";
      debugText.textContent = "Iniciando requisi√ß√£o para Pollo.ai API...";
      
      try {
        // Primeiro, testar se a API est√° acess√≠vel
        debugText.textContent += "\n\n1. Testando conex√£o com a API...";
        
        const testeConexao = await fetch("https://pollo.ai/api/health", {
          method: "GET",
          headers: {
            "x-api-key": API_KEY
          }
        }).catch(e => {
          debugText.textContent += "\n‚ùå Erro na conex√£o: " + e.message;
          return null;
        });
        
        if (testeConexao && testeConexao.ok) {
          debugText.textContent += "\n‚úÖ Conex√£o com API estabelecida!";
        } else {
          debugText.textContent += "\n‚ö†Ô∏è N√£o foi poss√≠vel testar conex√£o direta";
        }
        
        // Agora tentar gerar o v√≠deo
        debugText.textContent += "\n\n2. Enviando requisi√ß√£o para gerar v√≠deo...";
        status.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;"><span style="margin-right:10px;">üé¨</span> Gerando v√≠deo IA (20-40 segundos)...</div>';
        
        const response = await fetch("https://pollo.ai/api/platform/generation/pika/pika-v2-2", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": API_KEY
          },
          body: JSON.stringify({
            input: {
              prompt: `Avatar masculino jovem futurista, olhos azuis brilhantes, 
                      cabelo moderno, roupa tecnol√≥gica, fundo hologr√°fico com part√≠culas flutuantes,
                      ilumina√ß√£o neon azul e roxa, alta qualidade, anima√ß√£o suave.
                      
                      NARRATIVA: "Bem-vindo √† era da intelig√™ncia artificial. 
                      Transforme seu neg√≥cio com tecnologia de ponta. 
                      Samuel Designer Pro Max - inova√ß√£o que impulsiona resultados."`,
              aspect_ratio: "16:9",
              model: "pika-v2-2"
            }
          })
        });
        
        debugText.textContent += "\n‚úÖ Requisi√ß√£o enviada. Status: " + response.status;
        
        if (!response.ok) {
          throw new Error(`Erro HTTP ${response.status}: ${response.statusText}`);
        }
        
        const data = await response.json();
        debugText.textContent += "\n\n3. Resposta da API recebida:";
        debugText.textContent += "\n" + JSON.stringify(data, null, 2);
        
        if (data.output && data.output[0] && data.output[0].uri) {
          videoUrlAtual = data.output[0].uri;
          
          status.className = "success";
          status.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;"><span style="margin-right:10px;">‚úÖ</span> V√≠deo gerado com sucesso!</div>';
          
          videoPlayer.src = videoUrlAtual;
          videoPlayer.classList.remove("hidden");
          
          document.getElementById("downloadSection").classList.remove("hidden");
          document.getElementById("videoInfo").textContent = `URL: ${videoUrlAtual.substring(0, 50)}...`;
          
          debugText.textContent += "\n\n‚úÖ V√çDEO GERADO: " + videoUrlAtual;
          
        } else {
          status.className = "error";
          status.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;"><span style="margin-right:10px;">‚ùå</span> API respondeu mas n√£o retornou v√≠deo.</div>';
          debugText.textContent += "\n‚ùå API n√£o retornou URI do v√≠deo";
        }
        
      } catch (error) {
        console.error("Erro detalhado:", error);
        
        status.className = "error";
        status.innerHTML = `<div style="text-align:center;">
          <div style="margin-bottom:10px;">‚ùå Erro ao conectar com a API</div>
          <div style="font-size:0.9rem;color:#ff9999;">${error.message}</div>
          <div style="margin-top:15px;font-size:0.9rem;">
            <strong>Poss√≠veis causas:</strong><br>
            1. Bloqueio CORS (hospede o site)<br>
            2. API Key inv√°lida ou sem cr√©ditos<br>
            3. API temporariamente indispon√≠vel
          </div>
        </div>`;
        
        debugText.textContent += "\n\n‚ùå ERRO CAPTURADO: " + error.message;
        debugText.textContent += "\nStack: " + error.stack;
      } finally {
        btnGerar.disabled = false;
        btnGerar.innerHTML = "üöÄ Gerar V√≠deo com IA";
      }
    }
    
    function usarVideoExemplo() {
      const status = document.getElementById("status");
      const videoPlayer = document.getElementById("videoPlayer");
      const downloadSection = document.getElementById("downloadSection");
      const videoInfo = document.getElementById("videoInfo");
      const debugInfo = document.getElementById("debugInfo");
      const debugText = document.getElementById("debugText");
      
      // V√≠deo de exemplo p√∫blico
      videoUrlAtual = "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4";
      
      status.className = "success";
      status.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;"><span style="margin-right:10px;">üé•</span> Usando v√≠deo de exemplo</div>';
      
      videoPlayer.src = videoUrlAtual;
      videoPlayer.classList.remove("hidden");
      
      downloadSection.classList.remove("hidden");
      videoInfo.textContent = "V√≠deo de exemplo (Big Buck Bunny - Dom√≠nio P√∫blico)";
      
      debugInfo.style.display = "block";
      debugText.textContent = "Usando v√≠deo de exemplo (fallback)\nURL: " + videoUrlAtual;
    }
    
    function baixarVideo() {
      if (!videoUrlAtual) {
        alert("Nenhum v√≠deo dispon√≠vel para download!");
        return;
      }
      
      const link = document.createElement('a');
      link.href = videoUrlAtual;
      
      // Gerar nome do arquivo
      const nomeArquivo = videoUrlAtual.includes('example') 
        ? 'video-exemplo-ia.mp4'
        : `video-ia-${Date.now()}.mp4`;
      
      link.download = nomeArquivo;
      link.target = '_blank';
      
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      // Feedback visual
      const btnDownload = document.getElementById("btnDownload");
      const originalText = btnDownload.innerHTML;
      btnDownload.innerHTML = "‚úÖ Download Iniciado!";
      
      setTimeout(() => {
        btnDownload.innerHTML = originalText;
      }, 2000);
    }
    
    // Teste autom√°tico ao carregar
    window.addEventListener('load', () => {
      document.getElementById("apiStatusText").textContent = "API Key carregada com sucesso";
      console.log("API Key carregada:", API_KEY.substring(0, 20) + "...");
    });
  </script>
</body>
</html>
